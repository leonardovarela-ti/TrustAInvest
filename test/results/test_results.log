TrustAInvest Integration Test Results
Run at: Thu Apr 17 10:27:29 CDT 2025
=======================================

Running test: failed_registration_test.sh
----------------------------------------
[0;33mStarting failed registration test...[0m
[0;33mStep 1: Starting the system...[0m
 Network test-network  Removing
 Network test-network  No resource found to remove
[0;33mStarting services (this may take a minute)...[0m
Compose can now delegate builds to bake for better performance.
 To do so, set COMPOSE_BAKE=true.
#0 building with "desktop-linux" instance using docker driver

#1 [kyc-worker internal] load build definition from Dockerfile.kyc-worker
#1 transferring dockerfile: 667B done
#1 DONE 0.0s

#2 [kyc-verifier-service internal] load build definition from Dockerfile
#2 transferring dockerfile: 763B done
#2 DONE 0.0s

#3 [user-registration-service internal] load build definition from Dockerfile.registration
#3 transferring dockerfile: 758B done
#3 DONE 0.0s

#4 [user-registration-service internal] load metadata for docker.io/library/golang:1.23-alpine
#4 ...

#5 [kyc-worker auth] library/alpine:pull token for registry-1.docker.io
#5 DONE 0.0s

#6 [kyc-worker auth] library/golang:pull token for registry-1.docker.io
#6 DONE 0.0s

#7 [user-registration-service internal] load metadata for docker.io/library/alpine:3.16
#7 DONE 0.7s

#4 [kyc-verifier-service internal] load metadata for docker.io/library/golang:1.23-alpine
#4 DONE 0.7s

#8 [kyc-verifier-service internal] load .dockerignore
#8 transferring context: 2B done
#8 DONE 0.0s

#9 [user-registration-service internal] load .dockerignore
#9 transferring context: 2B done
#9 DONE 0.0s

#10 [kyc-worker internal] load .dockerignore
#10 transferring context: 2B done
#10 DONE 0.0s

#11 [kyc-worker stage-1 1/3] FROM docker.io/library/alpine:3.16@sha256:452e7292acee0ee16c332324d7de05fa2c99f9994ecc9f0779c602916a672ae4
#11 resolve docker.io/library/alpine:3.16@sha256:452e7292acee0ee16c332324d7de05fa2c99f9994ecc9f0779c602916a672ae4 0.0s done
#11 DONE 0.0s

#12 [kyc-verifier-service builder 1/7] FROM docker.io/library/golang:1.23-alpine@sha256:b7486658b87d34ecf95125e5b97e8dfe86c21f712aa36fc0c702e5dc41dc63e1
#12 resolve docker.io/library/golang:1.23-alpine@sha256:b7486658b87d34ecf95125e5b97e8dfe86c21f712aa36fc0c702e5dc41dc63e1 0.0s done
#12 DONE 0.0s

#13 [kyc-worker internal] load build context
#13 transferring context: 105.23MB 5.0s
#13 transferring context: 108.12MB 5.3s done
#13 DONE 5.3s

#14 [user-registration-service internal] load build context
#14 transferring context: 231.54MB 5.3s done
#14 DONE 5.3s

#15 [kyc-worker builder 4/7] COPY go.mod go.sum* ./
#15 CACHED

#16 [user-registration-service builder 5/7] RUN go mod download
#16 CACHED

#17 [user-registration-service builder 3/7] RUN apk add --no-cache git
#17 CACHED

#18 [user-registration-service builder 4/7] COPY go.mod go.sum* ./
#18 CACHED

#19 [user-registration-service builder 5/7] RUN go mod download
#19 CACHED

#20 [user-registration-service builder 2/7] WORKDIR /app
#20 CACHED

#21 [user-registration-service builder 6/7] COPY . .
#21 ...

#22 [kyc-verifier-service internal] load build context
#22 transferring context: 231.54MB 5.7s done
#22 DONE 5.7s

#23 [kyc-verifier-service builder 2/7] RUN apk add --no-cache git
#23 CACHED

#24 [kyc-verifier-service builder 3/7] WORKDIR /app
#24 CACHED

#25 [kyc-verifier-service builder 4/7] COPY go.mod go.sum ./
#25 CACHED

#26 [kyc-verifier-service builder 5/7] RUN go mod download
#26 CACHED

#27 [kyc-verifier-service builder 6/7] COPY . .
#27 ...

#28 [kyc-worker builder 6/7] COPY . .
#28 DONE 6.5s

#29 [kyc-worker builder 7/7] RUN CGO_ENABLED=0 GOOS=linux go build -o /app/kyc-worker ./cmd/kyc-worker
#29 ...

#21 [user-registration-service builder 6/7] COPY . .
#21 DONE 10.7s

#30 [user-registration-service builder 7/7] RUN CGO_ENABLED=0 GOOS=linux go build -o /app/user-registration-service ./cmd/user-registration-service
#30 ...

#27 [kyc-verifier-service builder 6/7] COPY . .
#27 DONE 10.8s

#31 [kyc-verifier-service builder 7/7] RUN go mod tidy &&     CGO_ENABLED=0 GOOS=linux go build -o /kyc-verifier-service ./cmd/kyc-verifier-service
#31 0.605 go: downloading github.com/stretchr/testify v1.10.0
#31 2.190 go: downloading github.com/jackc/pgmock v0.0.0-20210724152146-4ad1a8207f65
#31 2.307 go: downloading github.com/cockroachdb/apd v1.1.0
#31 2.372 go: downloading github.com/gofrs/uuid v4.0.0+incompatible
#31 2.440 go: downloading github.com/shopspring/decimal v1.2.0
#31 2.467 go: downloading github.com/davecgh/go-spew v1.1.1
#31 2.516 go: downloading github.com/pmezard/go-difflib v1.0.0
#31 2.953 go: downloading github.com/google/go-cmp v0.5.5
#31 2.984 go: downloading github.com/pkg/errors v0.8.1
#31 2.987 go: downloading github.com/go-playground/assert/v2 v2.2.0
#31 3.018 go: downloading gopkg.in/check.v1 v1.0.0-20201130134442-10cb98267c6c
#31 3.126 go: downloading golang.org/x/xerrors v0.0.0-20200804184101-5ec99f83aff1
#31 3.181 go: downloading github.com/jmespath/go-jmespath/internal/testify v1.5.1
#31 3.369 go: downloading github.com/kr/pretty v0.3.0
#31 3.613 go: downloading github.com/rogpeppe/go-internal v1.8.0
#31 3.613 go: downloading github.com/kr/text v0.1.0
#31 ...

#29 [kyc-worker builder 7/7] RUN CGO_ENABLED=0 GOOS=linux go build -o /app/kyc-worker ./cmd/kyc-worker
#29 DONE 10.6s

#32 [user-registration-service stage-1 2/4] WORKDIR /app
#32 CACHED

#33 [user-registration-service stage-1 3/4] RUN apk add --no-cache ca-certificates tzdata
#33 CACHED

#34 [kyc-worker stage-1 4/4] COPY --from=builder /app/kyc-worker .
#34 DONE 0.1s

#30 [user-registration-service builder 7/7] RUN CGO_ENABLED=0 GOOS=linux go build -o /app/user-registration-service ./cmd/user-registration-service
#30 ...

#35 [kyc-worker] exporting to image
#35 exporting layers
#35 exporting layers 1.4s done
#35 exporting manifest sha256:7b73c1e1a4aa86caf14d28735efdad3e4bbdd58549d1c147eaf717f27f4f1859
#35 exporting manifest sha256:7b73c1e1a4aa86caf14d28735efdad3e4bbdd58549d1c147eaf717f27f4f1859 0.1s done
#35 exporting config sha256:6839ff22c3838f2f3559def8106ac653f1244156db4e72ab5121cfa2f3c9d1c5 0.1s done
#35 exporting attestation manifest sha256:e514924537555c12887d73a513820769f4d44f32bad44128f2db6dd1db603ed2 0.1s done
#35 exporting manifest list sha256:d5a1467f512f11e6929f4397fa4b23f3120589096f3af4491011bcbbd6811bb7
#35 exporting manifest list sha256:d5a1467f512f11e6929f4397fa4b23f3120589096f3af4491011bcbbd6811bb7 0.1s done
#35 naming to docker.io/library/test-kyc-worker:latest 0.0s done
#35 unpacking to docker.io/library/test-kyc-worker:latest
#35 unpacking to docker.io/library/test-kyc-worker:latest 0.2s done
#35 DONE 2.0s

#31 [kyc-verifier-service builder 7/7] RUN go mod tidy &&     CGO_ENABLED=0 GOOS=linux go build -o /kyc-verifier-service ./cmd/kyc-verifier-service
#31 ...

#36 [kyc-worker] resolving provenance for metadata file
#36 DONE 0.0s

#31 [kyc-verifier-service builder 7/7] RUN go mod tidy &&     CGO_ENABLED=0 GOOS=linux go build -o /kyc-verifier-service ./cmd/kyc-verifier-service
#31 DONE 22.9s

#30 [user-registration-service builder 7/7] RUN CGO_ENABLED=0 GOOS=linux go build -o /app/user-registration-service ./cmd/user-registration-service
#30 DONE 23.5s

#37 [user-registration-service stage-1 4/4] COPY --from=builder /app/user-registration-service .
#37 DONE 0.1s

#38 [user-registration-service] exporting to image
#38 exporting layers
#38 ...

#11 [user-registration-service stage-1 1/3] FROM docker.io/library/alpine:3.16@sha256:452e7292acee0ee16c332324d7de05fa2c99f9994ecc9f0779c602916a672ae4
#11 CACHED

#11 [kyc-verifier-service stage-1 1/3] FROM docker.io/library/alpine:3.16@sha256:452e7292acee0ee16c332324d7de05fa2c99f9994ecc9f0779c602916a672ae4
#11 CACHED

#39 [kyc-verifier-service stage-1 2/3] COPY --from=builder /kyc-verifier-service /kyc-verifier-service
#39 DONE 0.0s

#38 [user-registration-service] exporting to image
#38 exporting layers 0.6s done
#38 exporting manifest sha256:e3947d1aa5fa763fff071db5f233587852615570109743e028746bef58cf4aa7 0.0s done
#38 exporting config sha256:584b6806d745df8809b21ffeccf48db8e6ceace6aae4dbf92f8b4129a76c174f 0.0s done
#38 exporting attestation manifest sha256:2db654dcf23274514e5677b28047d3b5bad624018b2c6580abdcc006a32cf122 0.0s done
#38 exporting manifest list sha256:96009c268f9d7cb2ff42f01dadf99b271bc8c80cc6778cb334cd7bc1f4dfc067 0.0s done
#38 naming to docker.io/library/test-user-registration-service:latest done
#38 unpacking to docker.io/library/test-user-registration-service:latest 0.1s done
#38 DONE 0.7s

#40 [user-registration-service] resolving provenance for metadata file
#40 DONE 0.0s

#41 [kyc-verifier-service] exporting to image
#41 exporting layers 0.4s done
#41 exporting manifest sha256:c728a06bf5b431e88977b31cbb60fda9c8c613b8c48158e1e4fc751f768f3329
#41 exporting manifest sha256:c728a06bf5b431e88977b31cbb60fda9c8c613b8c48158e1e4fc751f768f3329 0.0s done
#41 exporting config sha256:3716ca53f447e93e9c316d9bf17f5f594c8ada60e3f82e507d81ece2d1fb10c9 done
#41 exporting attestation manifest sha256:dd7fa929cced60142711fcffce4d7a43810c8fcee403246eb2dac270854f5feb 0.0s done
#41 exporting manifest list sha256:16881ba58b191226e614f6604f800d3b5b65083d0245613adf588de7bb25b541 0.0s done
#41 naming to docker.io/library/test-kyc-verifier-service:latest done
#41 unpacking to docker.io/library/test-kyc-verifier-service:latest 0.1s done
#41 DONE 0.6s

#42 [kyc-verifier-service] resolving provenance for metadata file
#42 DONE 0.0s
 kyc-verifier-service  Built
 kyc-worker  Built
 user-registration-service  Built
 Network test-network  Creating
 Network test-network  Created
 Container test-redis-1  Creating
 Container test-postgres-1  Creating
 Container test-localstack-1  Creating
 Container test-localstack-1  Created
 Container test-redis-1  Created
 Container test-postgres-1  Created
 Container test-kyc-verifier-service-1  Creating
 Container test-user-registration-service-1  Creating
 Container test-kyc-worker-1  Creating
 Container test-kyc-verifier-service-1  Created
 Container test-user-registration-service-1  Created
 Container test-kyc-worker-1  Created
 Container test-postgres-1  Starting
 Container test-localstack-1  Starting
 Container test-redis-1  Starting
 Container test-localstack-1  Started
 Container test-redis-1  Started
 Container test-postgres-1  Started
 Container test-postgres-1  Waiting
 Container test-localstack-1  Waiting
 Container test-postgres-1  Waiting
 Container test-redis-1  Waiting
 Container test-localstack-1  Waiting
 Container test-postgres-1  Waiting
 Container test-redis-1  Healthy
 Container test-postgres-1  Healthy
 Container test-kyc-verifier-service-1  Starting
 Container test-postgres-1  Healthy
 Container test-postgres-1  Healthy
 Container test-localstack-1  Healthy
 Container test-kyc-worker-1  Starting
 Container test-localstack-1  Healthy
 Container test-user-registration-service-1  Starting
 Container test-kyc-worker-1  Started
 Container test-kyc-verifier-service-1  Started
 Container test-user-registration-service-1  Started
[0;33mWaiting for services to be ready...[0m
[0;33mChecking if user-registration-service is up...[0m
[0;32mUser registration service is up![0m
[0;33mTest Case 1: Attempting registration with missing required fields...[0m
Registration response: {"error":"First name cannot be empty"}
[0;32mTest passed: Registration failed as expected due to missing required fields[0m
[0;33mTest Case 2: Attempting registration with invalid email format...[0m
Registration response: {"errors":[{"field":"email","message":"Invalid email format"}]}
[0;32mTest passed: Registration failed as expected due to invalid email format[0m
[0;33mTest Case 3: Attempting registration with weak password...[0m
Registration response: {"errors":[{"field":"password","message":"Password must be at least 8 characters and include uppercase, lowercase, number, and special character"}]}
[0;32mTest passed: Registration failed as expected due to weak password[0m
[0;33mTest Case 4: Attempting email verification with invalid token...[0m
Verification response: {"error":"Invalid or expired verification token"}
[0;32mTest passed: Verification failed as expected due to invalid token[0m
[0;33mTest Case 5: Attempting registration with empty first_name...[0m
Registration response: {"error":"First name cannot be empty"}
[0;32mTest passed: Registration failed as expected due to empty first_name[0m
[0;33mTest Case 5b: Attempting registration with whitespace-only first_name...[0m
Registration response: {"error":"First name cannot be empty"}
[0;32mTest passed: Registration failed as expected due to whitespace-only first_name[0m
[0;33mTest Case 6: Register a user, then try to register with the same username...[0m
First registration response: {"message":"User registered successfully. Please check your email to verify your account.","user_id":"45fa0042-558f-4e9c-a5d2-1bdb17d722b0"}
Second registration response: {"error":"Username already taken"}
[0;32mTest passed: Second registration failed as expected due to duplicate username[0m
[0;32mAll failed registration tests passed successfully![0m
[0;33mCleaning up...[0m
 Container test-kyc-verifier-service-1  Stopping
 Container test-kyc-worker-1  Stopping
 Container test-user-registration-service-1  Stopping
 Container test-kyc-verifier-service-1  Stopped
 Container test-kyc-verifier-service-1  Removing
 Container test-kyc-verifier-service-1  Removed
 Container test-kyc-worker-1  Stopped
 Container test-kyc-worker-1  Removing
 Container test-user-registration-service-1  Stopped
 Container test-user-registration-service-1  Removing
 Container test-kyc-worker-1  Removed
 Container test-user-registration-service-1  Removed
 Container test-localstack-1  Stopping
 Container test-postgres-1  Stopping
 Container test-redis-1  Stopping
 Container test-redis-1  Stopped
 Container test-redis-1  Removing
 Container test-postgres-1  Stopped
 Container test-postgres-1  Removing
 Container test-redis-1  Removed
 Container test-postgres-1  Removed
 Container test-localstack-1  Stopped
 Container test-localstack-1  Removing
 Container test-localstack-1  Removed
 Network test-network  Removing
 Network test-network  Removed
RESULT: PASSED

========================================

Running test: integration_test.sh
----------------------------------------
